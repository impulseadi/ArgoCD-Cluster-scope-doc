How to set up monitoring
Step 1: Set Up Helm (If Not Installed)
curl -fsSL -o get_helm.sh https://raw.githubusercontent.com/helm/helm/main/scripts/get-helm-3
chmod 700 get_helm.sh
./get_helm.sh
helm version


Step 2: Add the Prometheus & Grafana Helm Repository
helm repo add prometheus-community https://prometheus-community.github.io/helm-charts
helm repo update


Step 3: Install Prometheus using Helm
kubectl create namespace monitoring
helm install prometheus prometheus-community/kube-prometheus-stack --namespace monitoring

Step 4: Expose Grafana via a LoadBalancer
kubectl patch svc prometheus-grafana -n monitoring -p '{"spec": {"type": "LoadBalancer"}}'


Step 5: Get the Grafana LoadBalancer URL
kubectl get svc -n monitoring prometheus-grafana


Expose Prometheus as a Load Balancer
Patch the Prometheus Service
kubectl patch svc prometheus-kube-prometheus-prometheus -n monitoring -p '{"spec": {"type": "LoadBalancer"}}'

 
Access Prometheus on web browser 




Step 6: Access Grafana
Open http://<EXTERNAL-IP>:80 in your browser.
Default Login Credentials:
Username: admin
Password: prom-operator (Default, change after login)


Step 7: Configure Dashboards in Grafana
1.Log in to Grafana.
2.Go to Configuration → Data Sources.



Search for Prometheus and click on 

3.Add Prometheus as a data source:

oURL: http://ab59ce675697348409508ab1c889c0ee-1859429770.sa-east-1.elb.amazonaws.com:9090


oClick Save & Test.








4.Go to Dashboards → Import, and enter ID: 315 (Kubernetes Metrics Dashboard).


Provide k8s metrics dashboard id and click on load 





You will get page like this


Next you need to select your Prometheus dashboard as shown below pic






Our Grafana dashboard is ready



Now go to Prometheus and get targets 







# Installation commands 

helm repo add prometheus-community https://prometheus-community.github.io/helm-charts
helm repo add grafana https://grafana.github.io/helm-charts
helm repo update

helm install prometheus prometheus-community/prometheus --namespace monitoring --create-namespace

helm install grafana grafana/grafana --namespace monitoring


THE END
